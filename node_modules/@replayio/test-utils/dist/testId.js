"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.generateOpaqueId = exports.buildTestId = void 0;
const sha_1_1 = __importDefault(require("sha-1"));
function buildTestId(sourcePath, test) {
    const id = generateOpaqueId([sourcePath, test.id, ...test.source.scope, test.source.title].join("-"));
    return id;
}
exports.buildTestId = buildTestId;
const gIdCache = new Map();
function generateOpaqueId(contents) {
    if (gIdCache.has(contents)) {
        return gIdCache.get(contents);
    }
    let id;
    if ("window" in globalThis) {
        // in the browser, we're using this sync sha-1 lib because the built-in
        // crypto is async which causes problems with Cypress
        id = (0, sha_1_1.default)(contents);
    }
    else {
        // In node, rely on the crypto package instead
        id = require("crypto").createHash("sha1").update(contents).digest("hex");
    }
    gIdCache.set(contents, id);
    return id;
}
exports.generateOpaqueId = generateOpaqueId;
//# sourceMappingURL=testId.js.map